<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Drawing world maps using R</title>
  <meta name="description" content="Previously I posted about using googleVis  to create MotionChart or Maps. Recently in my work, I need to reproduce and modify a map of America from Reich et ...">

  <link rel="stylesheet" href="/yluo86.github.io//css/main.css">

  <link rel="canonical" href="http://AiGene.com/yluo86.github.io//rmaps">
  <link rel="alternate" type="application/rss+xml" title="AiGenome" href="http://AiGene.com/yluo86.github.io//feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/yluo86.github.io//">AiGenome</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/yluo86.github.io//Blogs.html">Blogs</a>
          
        
          
          <a class="page-link" href="/yluo86.github.io//about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/yluo86.github.io//links.html">Links</a>
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>

    <div class="sidebar">
	<div>


		<a class="sidebar-nav-item" href="/yluo86.github.io//">Categories</a>
		<ul>
			
			<li>
				<a onclick="redirect('/categories.html#science')">
				
				<b>science</b>
				
				</a>
				<sup>[8]</sup>
			</li>
			
			<li>
				<a onclick="redirect('/categories.html#paper')">
				
					paper
				
				</a>
				<sup>[1]</sup>
			</li>
			
			<li>
				<a onclick="redirect('/categories.html#snippets')">
				
					snippets
				
				</a>
				<sup>[2]</sup>
			</li>
			
			<li>
				<a onclick="redirect('/categories.html#presentation')">
				
					presentation
				
				</a>
				<sup>[5]</sup>
			</li>
			
		</ul>
		<hr/>
		<a class="sidebar-nav-item" href="/yluo86.github.io//">Tags</a>
		<ul class="sidebar_tags">
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#23andme')">
<!-- 				<a href="/blog/tag/testtag#23andme"> -->
				
					23andme
				
				</a>
				<sup>[1]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#ancestry')">
<!-- 				<a href="/blog/tag/testtag#ancestry"> -->
				
					ancestry
				
				</a>
				<sup>[1]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#GWAS')">
<!-- 				<a href="/blog/tag/testtag#GWAS"> -->
				
					GWAS
				
				</a>
				<sup>[2]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#TB')">
<!-- 				<a href="/blog/tag/testtag#TB"> -->
				
					TB
				
				</a>
				<sup>[1]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#pipeline')">
<!-- 				<a href="/blog/tag/testtag#pipeline"> -->
				
					pipeline
				
				</a>
				<sup>[1]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#bioinformatics')">
<!-- 				<a href="/blog/tag/testtag#bioinformatics"> -->
				
					<b>bioinformatics</b>
				
				</a>
				<sup>[3]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#R')">
<!-- 				<a href="/blog/tag/testtag#R"> -->
				
					<b>R</b>
				
				</a>
				<sup>[2]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#poster')">
<!-- 				<a href="/blog/tag/testtag#poster"> -->
				
					poster
				
				</a>
				<sup>[2]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#conference')">
<!-- 				<a href="/blog/tag/testtag#conference"> -->
				
					conference
				
				</a>
				<sup>[4]</sup>

<!-- 			</li> -->
			
<!-- 			<li> -->
				<a onclick="redirect('/tags.html#ASHG')">
<!-- 				<a href="/blog/tag/testtag#ASHG"> -->
				
					ASHG
				
				</a>
				<sup>[4]</sup>

<!-- 			</li> -->
			
		</ul>
		<hr/>
	</div>
</div>

<script type="text/javascript">
	function redirect(url){
		//alert(url);
		window.history.pushState('test', "Title", url);
		//window.location.href=url;
		window.location.reload();
	}

</script>

    <div class="page-content">
      <div class="wrapper">
        <div class="post">
  <h1 class="post-title">Drawing world maps using R</h1>
  <span class="post-date">13 Mar 2018</span>
  <p>Previously I posted about using <a href="https://github.com/mages/googleVis">googleVis</a>  to create <a href="/yluo86.github.io//MotionChart.html">MotionChart</a> or Maps. Recently in my work, I need to reproduce and modify a map of America from <a href="https://www.nature.com/articles/nature11258">Reich et al 2012</a> Nature paper on <em>reconstructing Native American population history</em>. To keep it brief, I want to modify a map based on the original paper (left), but with customized information (right) without manually manipulating the figure in graphics softwares.<img src="/yluo86.github.io//assets/images/nat_map.png" alt="original" /></p>

<p>To start, here are the prerequisties you need to install:</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="c1"># dependency libraries
</span><span class="n">install.packages</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"ggplot2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"devtools"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dplyr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"stringr"</span><span class="p">,</span><span class="s2">"ggrepel"</span><span class="p">))</span><span class="w">

</span><span class="c1"># install map packages.
</span><span class="n">install.packages</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"maps"</span><span class="p">,</span><span class="w"> </span><span class="s2">"mapdata"</span><span class="p">))</span><span class="w">

</span><span class="c1"># load up required libraries
</span><span class="n">require</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">require</span><span class="p">(</span><span class="n">ggrepel</span><span class="p">)</span><span class="w">
</span><span class="n">require</span><span class="p">(</span><span class="n">maps</span><span class="p">)</span><span class="w">
</span><span class="n">require</span><span class="p">(</span><span class="n">mapdata</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Now you can basically draw any map thatâ€™s already in the mapdata library</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">world</span><span class="o">&lt;-</span><span class="n">map_data</span><span class="p">(</span><span class="s2">"world"</span><span class="p">)</span><span class="w">
</span><span class="n">world</span><span class="p">[</span><span class="n">sample</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">world</span><span class="p">),</span><span class="m">10</span><span class="p">),]</span><span class="w">
</span><span class="c1">#            long       lat group order           region       subregion
#79207   31.25879  53.01670  1309 79207           Russia            &lt;NA&gt;
#45362  -88.57159  15.90107   665 45362        Guatemala            &lt;NA&gt;
#45012  -69.69424  76.98946   664 45012        Greenland            &lt;NA&gt;
#73720  150.36406 -10.18965  1195 73720 Papua New Guinea            &lt;NA&gt;
#49830  105.71856   2.85918   813 49830        Indonesia          Jemaja
#10850   26.48926  44.08398   197 10850         Bulgaria            &lt;NA&gt;
#92946  -76.24424  36.95264  1501 92946              USA            &lt;NA&gt;
#24227 -113.87852  75.37544   368 24227           Canada Melville Island
#65955   22.62402 -17.78164  1041 65955          Namibia            &lt;NA&gt;
#89250   60.93320  41.22900  1418 89250     Turkmenistan            &lt;NA&gt;  
</span></code></pre>
</div>

<p>The data is organized as a data frame with longitude and latitude information of each country/region. Next step is to identify regions of interests. For me, this includes all <a href="/yluo86.github.io//assets/data/amr_countries.txt">South American countries</a>, but you can pick whatever you like.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="c1">#selecting countries of interest, this steps need some manual curation, some of the countries might have a different quoted name
</span><span class="n">countrylist</span><span class="o">&lt;-</span><span class="n">scan</span><span class="p">(</span><span class="s2">"data/amr_countries.txt"</span><span class="p">,</span><span class="nf">as.character</span><span class="p">())</span><span class="w">

</span><span class="n">lat</span><span class="o">&lt;-</span><span class="n">map_data</span><span class="p">(</span><span class="s2">"world"</span><span class="p">,</span><span class="n">region</span><span class="o">=</span><span class="n">countrylist</span><span class="p">)</span><span class="w">
</span><span class="c1">#remove some islands for visually pleasing effects
</span><span class="n">idx</span><span class="o">&lt;-</span><span class="n">which</span><span class="p">(</span><span class="n">lat</span><span class="o">$</span><span class="n">long</span><span class="o">&lt;=</span><span class="m">-75</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">lat</span><span class="o">$</span><span class="n">lat</span><span class="o">&lt;=</span><span class="m">-20</span><span class="p">)</span><span class="w">

</span><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="c1">#here is the background map for region of interest
</span><span class="n">g</span><span class="m">1</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_polygon</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat</span><span class="p">[</span><span class="o">-</span><span class="n">idx</span><span class="p">,],</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group</span><span class="p">),</span><span class="n">fill</span><span class="o">=</span><span class="s1">'NA'</span><span class="p">,</span><span class="n">colour</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_fixed</span><span class="p">(</span><span class="m">1.5</span><span class="p">)</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">g</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>
<p><img src="/yluo86.github.io//assets/images/nat_plot_raw.png" alt="nat_map" />
So we now have the background map, and we can now add some labels on top! This requires knowing geographical coordinates of your data points. To me, these are the Native American populations sampled from the 2012 paper. Luckily, authors did a great job in including all geographical information in their supplementary table (<a href="/yluo86.github.io//assets/data/nat_pop.txt">ST1</a>). All I needed to do is to extract the information and project it onto the background map.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="c1">#native american population of interest
# 52 Native american population based on Reich et al. 2012 (Supplementary Table 1)
</span><span class="n">nat</span><span class="o">&lt;-</span><span class="n">read.table</span><span class="p">(</span><span class="s2">"data/nat_pop.txt"</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="nb">T</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">"\t"</span><span class="p">,</span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="n">nat</span><span class="o">$</span><span class="n">lat</span><span class="o">&lt;-</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">nat</span><span class="o">$</span><span class="n">Latitude</span><span class="p">)</span><span class="w">

</span><span class="c1">#for populations with multiple sampling locations, I took the average of the two
</span><span class="n">nat</span><span class="p">[</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"/"</span><span class="p">,</span><span class="n">nat</span><span class="o">$</span><span class="n">Latitude</span><span class="p">),]</span><span class="o">$</span><span class="n">lat</span><span class="o">&lt;-</span><span class="n">rowMeans</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">unlist</span><span class="p">(</span><span class="n">strsplit</span><span class="p">(</span><span class="n">nat</span><span class="p">[</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"/"</span><span class="p">,</span><span class="n">nat</span><span class="o">$</span><span class="n">Latitude</span><span class="p">),]</span><span class="o">$</span><span class="n">Latitude</span><span class="p">,</span><span class="s2">"/"</span><span class="p">))),</span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">byrow</span><span class="o">=</span><span class="nb">T</span><span class="p">))</span><span class="w">
</span><span class="n">nat</span><span class="o">$</span><span class="n">long</span><span class="o">&lt;-</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">nat</span><span class="o">$</span><span class="n">Longitude</span><span class="p">)</span><span class="w">
</span><span class="n">nat</span><span class="p">[</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"/"</span><span class="p">,</span><span class="n">nat</span><span class="o">$</span><span class="n">Longitude</span><span class="p">),]</span><span class="o">$</span><span class="n">long</span><span class="o">&lt;-</span><span class="n">rowMeans</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">unlist</span><span class="p">(</span><span class="n">strsplit</span><span class="p">(</span><span class="n">nat</span><span class="p">[</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"/"</span><span class="p">,</span><span class="n">nat</span><span class="o">$</span><span class="n">Longitude</span><span class="p">),]</span><span class="o">$</span><span class="n">Longitude</span><span class="p">,</span><span class="s2">"/"</span><span class="p">))),</span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">byrow</span><span class="o">=</span><span class="nb">T</span><span class="p">))</span><span class="w">

</span><span class="c1">#define sub populations of interests
</span><span class="n">andean</span><span class="o">&lt;-</span><span class="n">nat</span><span class="p">[</span><span class="n">nat</span><span class="o">$</span><span class="n">Population</span><span class="o">==</span><span class="s2">"Aymara"</span><span class="o">|</span><span class="n">nat</span><span class="o">$</span><span class="n">Population</span><span class="o">==</span><span class="s2">"Quechua"</span><span class="p">,]</span><span class="w">
</span><span class="n">northen_amerind</span><span class="o">&lt;-</span><span class="n">nat</span><span class="p">[</span><span class="n">nat</span><span class="o">$</span><span class="n">Population</span><span class="w"> </span><span class="o">%in%</span><span class="nf">c</span><span class="p">(</span><span class="s2">"Maya1"</span><span class="w">   </span><span class="p">,</span><span class="w">  </span><span class="s2">"Mixe"</span><span class="w">    </span><span class="p">,</span><span class="w">    </span><span class="s2">"Kaqchikel"</span><span class="w">  </span><span class="p">),]</span><span class="w">
</span><span class="n">central_amerind</span><span class="o">&lt;-</span><span class="n">nat</span><span class="p">[</span><span class="n">nat</span><span class="o">$</span><span class="n">Population</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Pima"</span><span class="w">   </span><span class="p">,</span><span class="w">   </span><span class="s2">"Zapotec1"</span><span class="w">  </span><span class="p">,</span><span class="s2">"Mixtec"</span><span class="w">    </span><span class="p">,</span><span class="s2">"Yaqui"</span><span class="w">  </span><span class="p">,</span><span class="w">   </span><span class="s2">"Chorotega"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"Tepehuano"</span><span class="p">),]</span><span class="w">
</span><span class="n">south_amerind</span><span class="o">&lt;-</span><span class="n">nat</span><span class="p">[</span><span class="n">nat</span><span class="o">$</span><span class="n">Population</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Piapoco"</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="s2">"Karitiana"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Surui"</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="s2">"Wayuu"</span><span class="w">  </span><span class="p">,</span><span class="w">   </span><span class="s2">"Jamamadi"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"Parakana"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"Guarani"</span><span class="w"> </span><span class="p">,</span><span class="w">
                                         </span><span class="s2">"Kaingang"</span><span class="p">,</span><span class="w">  </span><span class="s2">"Ticuna"</span><span class="w"> </span><span class="p">,</span><span class="w">   </span><span class="s2">"Palikur"</span><span class="p">,</span><span class="w">   </span><span class="s2">"Toba"</span><span class="w">    </span><span class="p">,</span><span class="w">  </span><span class="s2">"Arara"</span><span class="w"> </span><span class="p">,</span><span class="w">    </span><span class="s2">"Wichi"</span><span class="w">     </span><span class="p">,</span><span class="s2">"Chane"</span><span class="w">  </span><span class="p">,</span><span class="w">  
                                         </span><span class="s2">"Guahibo"</span><span class="w"> </span><span class="p">),]</span><span class="w">
</span><span class="n">pops</span><span class="o">&lt;-</span><span class="n">rbind</span><span class="p">(</span><span class="n">andean</span><span class="p">,</span><span class="n">northen_amerind</span><span class="p">,</span><span class="n">central_amerind</span><span class="p">,</span><span class="n">south_amerind</span><span class="p">)</span><span class="w">

</span><span class="n">df</span><span class="o">&lt;-</span><span class="n">nat</span><span class="p">[</span><span class="n">nat</span><span class="o">$</span><span class="n">Population</span><span class="o">%in%</span><span class="n">pops</span><span class="o">$</span><span class="n">Population</span><span class="p">,]</span><span class="w">

</span><span class="c1">#modify with multiple names
</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">Population</span><span class="o">==</span><span class="s2">"Maya1"</span><span class="p">,]</span><span class="o">$</span><span class="n">Population</span><span class="o">&lt;-</span><span class="s2">"Maya"</span><span class="w">
</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">Population</span><span class="o">==</span><span class="s2">"Zapotec1"</span><span class="w"> </span><span class="p">,]</span><span class="o">$</span><span class="n">Population</span><span class="o">&lt;-</span><span class="s2">"Zapotec"</span><span class="w">
</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="o">&lt;-</span><span class="s2">"NA"</span><span class="w">
</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="o">&lt;-</span><span class="n">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Language.family</span><span class="o">==</span><span class="s2">"Equatorial-Tucanoan"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">Language.family</span><span class="o">==</span><span class="s2">"Ge-Pano-Carib"</span><span class="p">,</span><span class="s2">"Southern Amerindian"</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="p">)</span><span class="w">
</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="o">&lt;-</span><span class="n">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Language.family</span><span class="o">==</span><span class="s2">"Central-Amerind"</span><span class="p">,</span><span class="s2">"Central Amerindian"</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="p">)</span><span class="w">
</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="o">&lt;-</span><span class="n">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Language.family</span><span class="o">==</span><span class="s2">"Northern Amerind"</span><span class="p">,</span><span class="s2">"Northern Amerindian"</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="p">)</span><span class="w">
</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="o">&lt;-</span><span class="n">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Language.family</span><span class="o">==</span><span class="s2">"Andean"</span><span class="p">,</span><span class="s2">"Andean"</span><span class="p">,</span><span class="n">df</span><span class="o">$</span><span class="n">region</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>With some data curation, we are now ready to plot the final product! And a side note, <a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html">ggrepel</a> is such a great package if you have a lot of labelling to do. You can see below what a difference it makes before and after.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">p</span><span class="m">2</span><span class="o">&lt;-</span><span class="n">g</span><span class="m">1</span><span class="o">+</span><span class="w">  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="n">colour</span><span class="o">=</span><span class="n">region</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="w">
    </span><span class="n">geom_text_repel</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Population</span><span class="p">,</span><span class="n">colour</span><span class="o">=</span><span class="n">region</span><span class="p">),</span><span class="n">box.padding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.4</span><span class="p">,</span><span class="n">point.padding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">show.legend</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="o">+</span><span class="w">
     </span><span class="n">theme_void</span><span class="p">()</span><span class="o">+</span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">.2</span><span class="p">,</span><span class="w"> </span><span class="m">.3</span><span class="p">),</span><span class="n">legend.title</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">p</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/yluo86.github.io//assets/images/nat_map_final.png" alt="nat_map" /></p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/yluo86.github.io//ashg2017mhc">
            Novel high-resolution multi-ethnic HLA imputation reference panels constructed based on high-coverage whole-genome sequencing data
            <small>10 Oct 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/yluo86.github.io//ashg2017">
            Genome-Wide Association in Peru Demonstrates that Progression to Active Tuberculosis is a Polygenic and Highly Heritable Trait
            <small>02 Oct 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/yluo86.github.io//ashg2016">
            Post ASHG 2016
            <small>20 Oct 2016</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">AiGenome</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>AiGenome</li>
          <li><a href="mailto:yangluo86@gmail.com">yangluo86@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/yluo86"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">yluo86</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/yluo86"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">yluo86</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>

</html>
